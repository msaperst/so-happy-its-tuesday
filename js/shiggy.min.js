
$(document).ready(function(){var deleteIcon=$("<i>");deleteIcon.addClass("fa fa-trash-o");var deletePositionButton=$("<button>");deletePositionButton.addClass("btn btn-sm btn-danger");deletePositionButton.attr("title","Delete Position");deletePositionButton.append(deleteIcon.clone());var removeHasherButton=$("<button>");removeHasherButton.addClass("btn btn-xsm btn-danger");removeHasherButton.attr("title","Remove Hasher");removeHasherButton.append(deleteIcon.clone());$('#editMismanagement').click(function(){$(this).addClass('hidden');$('#saveMismanagement').removeClass('hidden');$('#addPosition').removeClass('hidden');$('.mismanagement').each(function(){var cell=$("<td>");cell.addClass("delete");delButton=deletePositionButton.clone();delButton.attr("style","margin:8px 0px;");delButton.click(function(){$(this).closest('tr').remove();});cell.append(delButton);$(this).find('td').eq(0).before(cell);var position_cell=$(".position",this);var position_title=position_cell.html();var position_input=$("<input>");position_input.addClass("form-control");position_input.attr("style","min-width:300px;margin:4px 0px;");position_input.attr("placeholder","Enter Position Title");position_input.val(position_title);position_cell.empty().append(position_input);var whois_cell=$(".whois",this);$(".hidden",whois_cell).removeClass("hidden");});$(".viewHasher").each(function(){$(this).addClass('hasher');$(this).append(removeHasherButton.clone());$(this).closest(".whois").find(".holder").append($(this));});$(".hasherholder").each(function(){$(this).remove();});addDeleteHasher();});$('#addPosition').click(function(){var row=$("<tr class='mismanagement'>");var deleteCell=$("<td>");deleteCell.addClass("delete");delButton=deletePositionButton.clone();delButton.attr("style","margin:8px 0px;");delButton.click(function(){$(this).closest('tr').remove();});deleteCell.append(delButton);row.append(deleteCell);var positionCell=$("<td>");positionCell.addClass("position");var position_input=$("<input>");position_input.addClass("form-control");position_input.attr("style","min-width:300px;margin:4px 0px;");position_input.attr("placeholder","Enter Position Title");positionCell.append(position_input);row.append(positionCell);var whoisCell=$("<td>");whoisCell.addClass("whois");whoisSearch=$("<input>");whoisSearch.attr("placeholder","Find a wanker");whoisSearch.attr("style","position:relative;top:2px;");whoisSearch.addClass("searcher form-control");var whoisSearchSpan=$("<span>");whoisSearchSpan.append(whoisSearch);whoisCell.append(whoisSearchSpan);whoisSpan=$("<span>");whoisSpan.addClass("holder");whoisCell.append(whoisSpan);row.append(whoisCell);$('table#mismanagement tbody').append(row);startSearching();});$('#saveMismanagement').click(function(){var mismanagement=new Object();$('.mismanagement').each(function(){var position=$(this).find('.position input').val();var who=$(this).find('.whois .holder span');var who_is=[];who.each(function(){who_is.push($(this).attr('hasherid'));});mismanagement[position]=who_is;});$.ajax({type:"POST",url:"php/update-mismanagement.php",data:{mismanagement:mismanagement}}).done(function(){$('table#mismanagement tr').each(function(){$(".delete",this).remove();$(".position",this).html($(".position input",this).val());$(".whois .holder span",this).each(function(){$(this).removeClass('hasher');$("button",this).remove();var div=$("<div>");div.addClass("hasherholder");$(this).parent().parent().append(div);div.append($(this));});$(".whois>span:first-child",this).addClass("hidden");$('#saveMismanagement').addClass('hidden');$('#addPosition').addClass('hidden');$('#editMismanagement').removeClass('hidden');});});});$('#hareLogLookup').keyup(function(){var lookup=$(this).val();$('#harelog tbody tr').each(function(){if($(".hashname",this).html().toLowerCase().indexOf(lookup.toLowerCase())>=0){$(this).show();}else{$(this).hide();}});});$('.editHasher').click(function(){$('#hasherModal').modal();$.get("php/get-hasher.php",{id:$(this).closest('tr').attr('hasher-id')}).done(function(data){data=$.parseJSON(data);$('#hashName').val(data.hashname);$('#nerdName').val(data.nerdname);$('#email').val(data.email);$('#phone').val(data.phone);$('#address').val(data.address);$('#city').val(data.city);$('#state').val(data.state);$('#zip').val(data.zip);$('#hasher-id').val(data.ID);});});$('#addHasher').click(function(){$('#hashName').val("");$('#nerdName').val("");$('#email').val("");$('#phone').val("");$('#address').val("");$('#city').val("");$('#state').val("");$('#zip').val("");$('#hasher-id').val("");});$('#hasherSave').click(function(){var hasher={};hasher.hashname=$('#hashName').val();hasher.nerdname=$('#nerdName').val();hasher.email=$('#email').val();hasher.phone=$('#phone').val();hasher.address=$('#address').val();hasher.city=$('#city').val();hasher.state=$('#state').val();hasher.zip=$('#zip').val();if($('#hasher-id').val()!=""){hasher.id=$('#hasher-id').val();}
$.ajax({type:"POST",url:"php/update-hasher.php",data:{data:hasher}}).done(function(){});$('#hasherModal').modal('hide');});$('.hashname').click(function(){var hasher_row=$(this).closest('tr');if(hasher_row.next().hasClass('display-count')){hasher_row.next().remove();}else{$.get("php/get-hare-count.php",{id:hasher_row.attr('hasher-id')}).done(function(data){data=$.parseJSON(data);var row=$("<tr class='display-count'>");var cell=$("<td colspan=3>");var close=$("<div class='close-hare-count'><a href='javascript:void(0);'><i class='fa fa-remove' style='padding:2px;'></i></a></div>");close.click(function(){$(this).closest('tr').remove();});cell.append(close);var table=$("<table style='width:100%'>");var thead=$("<thead><tr><th>Trail #</th><th>Trail Date</th><th>Title</th></tr></thead>");table.append(thead);var tbody=$("<tbody>");$.each(data,function(i,item){var row=$("<tr>");var cell=$("<td>");cell.html(item.TRL_ID);row.append(cell);var cell=$("<td>");cell.html(item.HASHDATE);row.append(cell);var cell=$("<td>");cell.html(item.TITLE);row.append(cell);tbody.append(row);});table.append(tbody);cell.append(table);row.append(cell);hasher_row.after(row);});}});});